为什么进程退出的时候没有内存泄漏？
--------
--------


最近，我一直在看关于内存相关的东西，有一个学弟问了我一个东西觉得还挺有意思的，就是他的C程序（很简单的一个）的内存分配`mallock()`和`free()`没有成对的出现，但是他惊奇的发现即使运行很多次（数量比较大，十几万次），系统并没有崩溃，甚至可以说没有发生内存泄漏，听到这里，我就懂了他对什么没有理解了。


学过C语言的人都知道，我们的`malloc`和`free`要成对出现，否则会发生内存泄漏，没错，这句话本身没错，但是如果这句话脱离了一些语境，那么这句话就是错的了，这句话其实是针对一个长时间运行的程序来说的，对于一个长时间运行的程序，比如我们的web服务器，数据库管理系统，操作系统(of course~),那么你长时间的 不释放掉一些内存就会出现很严重的问题，可能会出现内存不足而导致程序的崩溃，这就是说我们为什么一旦不用某些内存的时候需要调用free的真正含义，但是对于一个很小的程序，如果你在堆上面申请一些内存的话，那么在程序结束前即使你不释放的话，操作系统也会来帮你释放！

写过操作系统内核的人都知道在管理进程的时候，进程退出的时候，操作系统会回收进程的所有资源，所以从这个角度来看的话，只要操作系统是正确的话，进程退出的时候是没有内存泄漏。


